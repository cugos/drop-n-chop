function handleFiles(a){for(i=0;i<a.length;i++)readFile(a[i])}function readFile(a){var b=new FileReader;b.readAsText(a,"UTF-8"),b.onload=function(){var c=JSON.parse(b.result);addLayer(a,c,numLayers),numLayers++}}function addEventHandlers(){function a(){var a=this.nextSibling.nextSibling;-1==a.className.indexOf("expanded")?a.className+=" expanded":a.className="menu"}var b=window;b.addEventListener("dragover",function(a){a=a||event,a.preventDefault(),document.body.className="dragging"},!1),b.addEventListener("dragleave",function(a){a=a||event,a.preventDefault(),document.body.className=""},!1),b.addEventListener("drop",function(a){a=a||event,a.preventDefault(),document.body.className="",files=a.dataTransfer.files,handleFiles(files)},!1);var c=document.getElementById("buffer");c.addEventListener("click",function(){ops.execute(ops.geom.buffer(selection.list[0].layer._geojson,selection.list[0].info))});var d=document.getElementById("union");d.addEventListener("click",function(){ops.execute(ops.geom.union(selection.list[0].layer._geojson,selection.list[1].layer._geojson,selection.list[0].info,selection.list[1].info))});var e=document.getElementById("erase");e.addEventListener("click",function(){ops.execute(ops.geom.erase(selection.list[0].layer._geojson,selection.list[1].layer._geojson,selection.list[0].info,selection.list[1].info))});for(var f=document.getElementsByClassName("menu-expand"),g=0;g<f.length;g++)f[g].addEventListener("click",a,!1)}function init(){addEventHandlers(),setupMap()}function setupMap(){L.mapbox.accessToken="pk.eyJ1Ijoic3ZtYXR0aGV3cyIsImEiOiJVMUlUR0xrIn0.NweS_AttjswtN5wRuWCSNA",window.map=L.mapbox.map("map","svmatthews.hf8pfph5",{zoomControl:!1}).setView([0,0],3)}function addLayer(a,b,c){var d=L.mapbox.featureLayer(b).setZIndex(c).addTo(map),e=document.createElement("input");e.setAttribute("type","checkbox"),e.setAttribute("checked","true"),e.className="layer-toggle";var f=document.createElement("div");f.className="layer-name",f.innerHTML=a.name;var g=document.createElement("li");g.className="layer-element "+a.name,f.onclick=function(){-1==this.className.indexOf("selected")?(this.className+=" selected",selection.add({info:a,layer:d})):(selection.remove(d),this.className="layer-name")},e.onchange=function(){console.log(this),e.checked?map.addLayer(d):map.hasLayer(d)&&map.removeLayer(d)},document.getElementById("fileList").appendChild(g),g.appendChild(e),g.appendChild(f),numLayers++}function updateDownload(a){download.href="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a))}window.onload=init(),window.selection=[],window.numLayers=0,window.download=document.getElementById("download");var ops={execute:function(a){addLayer(a,a.geometry,numLayers)},geom:{buffer:function(a,b){console.log(a,b);var c={geometry:turf.buffer(a,.1),name:"buffer_"+b.name};return c},union:function(a,b,c,d){var e=a,f=b,g=c.name.replace(".geojson",""),h=d.name.replace(".geojson","");a.features&&(e=a.features[0]),b.features&&(f=b.features[0]);var i={geometry:turf.union(e,f),name:"union_"+g+"_"+h+".geojson"};return i},erase:function(a,b,c,d){var e=a,f=b,g=c.name.replace(".geojson",""),h=d.name.replace(".geojson",""),i={geometry:turf.erase(e,f),name:"erase_"+g+"_"+h+".geojson"};return i}}},selection={add:function(a){this.list.push(a)},remove:function(a){for(var b=0;b<this.list.length;b++)a._leaflet_id==this.list[b].layer._leaflet_id&&this.list.splice(b,1)},list:[]};
//# sourceMappingURL=app.js.map