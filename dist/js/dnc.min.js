!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./map"),d={version:"0.0.1-dev",map:c};"object"==typeof b&&"object"==typeof b.exports&&(b.exports=d),"undefined"!=typeof window&&(window.DNC=d)},{"./map":4}],2:[function(a,b){"use strict";var c=function(a){return this.options=a||{},this instanceof c?void document.addEventListener("register-dnc-event-handlers",function(){console.info("[ REGISTER ]: dropzone"),this.addEventHandlers()}.bind(this)):new c};c.prototype={readFile:function(a){var b=new FileReader;b.readAsText(a,"UTF-8"),b.onload=function(){var c=JSON.parse(b.result);DNC.map.addLayer(a,c,DNC.map.numLayers),DNC.map.numLayers++}},handleFiles:function(a){for(var b=0;b<a.length;b++)this.readFile(a[b])},addEventHandlers:function(){"undefined"!=typeof window&&(window.addEventListener("dragover",function(a){a=a||event,a.preventDefault(),document.body.className="dragging"},!1),window.addEventListener("dragleave",function(a){a=a||event,a.preventDefault(),document.body.className=""},!1),window.addEventListener("drop",function(a){a=a||event,a.preventDefault(),document.body.className="";var b=a.dataTransfer.files;this.handleFiles(b)}.bind(this),!1))}},b.exports=c},{}],3:[function(a,b){"use strict";var c=function(a){return this.options=a||{},this instanceof c?void document.addEventListener("register-dnc-event-handlers",function(){console.info("[ REGISTER ]: geoprocessing menu"),this.addEventHandlers()}.bind(this)):new c};c.prototype={addEventHandlers:function(){function a(){var a=this.nextSibling.nextSibling;-1==a.className.indexOf("expanded")?a.className+=" expanded":a.className="menu"}for(var b=document.getElementsByClassName("menu-expand"),c=0;c<b.length;c++)b[c].addEventListener("click",a,!1);var d=document.getElementById("buffer");d.addEventListener("click",function(){this.ops.execute(this.ops.geom.buffer(DNC.map.selection.list[0].layer._geojson,DNC.map.selection.list[0].info))}.bind(this));var e=document.getElementById("union");e.addEventListener("click",function(){this.ops.execute(this.ops.geom.union(DNC.map.selection.list[0].layer._geojson,DNC.map.selection.list[1].layer._geojson,DNC.map.selection.list[0].info,DNC.map.selection.list[1].info))}.bind(this));var f=document.getElementById("erase");f.addEventListener("click",function(){this.ops.execute(this.ops.geom.erase(DNC.map.selection.list[0].layer._geojson,DNC.map.selection.list[1].layer._geojson,DNC.map.selection.list[0].info,DNC.map.selection.list[1].info))}.bind(this))},ops:{execute:function(a){DNC.map.addLayer(a,a.geometry,DNC.map.numLayers)},geom:{buffer:function(a,b){console.log(a,b);var c={geometry:turf.buffer(a,.1),name:"buffer_"+b.name};return c},union:function(a,b,c,d){var e=a,f=b,g=c.name.replace(".geojson",""),h=d.name.replace(".geojson","");a.features&&(e=a.features[0]),b.features&&(f=b.features[0]);var i={geometry:turf.union(e,f),name:"union_"+g+"_"+h+".geojson"};return i},erase:function(a,b,c,d){var e=a,f=b,g=c.name.replace(".geojson",""),h=d.name.replace(".geojson",""),i={geometry:turf.erase(e,f),name:"erase_"+g+"_"+h+".geojson"};return i}}}},b.exports=c},{}],4:[function(a,b){"use strict";var c=a("../dropzone"),d=a("../geoprocessing_menu"),e=function(a){return this.options=a||{},this instanceof e?(this.numLayers=0,this.map=null,this.selection={add:function(a){this.list.push(a)},remove:function(a){for(var b=0;b<this.list.length;b++)a._leaflet_id==this.list[b].layer._leaflet_id&&this.list.splice(b,1)},list:[]},void(this.download=document.getElementById("download"))):new e};e.prototype={init:function(){DNC.dropzone=new c,DNC.menu=new d,this.addEventListeners(),this.setupMap()},addEventListeners:function(){console.log("[ DISPATCH ]: register event"),document.dispatchEvent(this.dnc_registration_event)},setupMap:function(){L.mapbox.accessToken="pk.eyJ1Ijoic3ZtYXR0aGV3cyIsImEiOiJVMUlUR0xrIn0.NweS_AttjswtN5wRuWCSNA",this.map=L.mapbox.map("map","svmatthews.hf8pfph5",{zoomControl:!1}).setView([0,0],3)},addLayer:function(a,b,c){var d=L.mapbox.featureLayer(b).setZIndex(c).addTo(this.map),e=document.createElement("input");e.setAttribute("type","checkbox"),e.setAttribute("checked","true"),e.className="layer-toggle";var f=document.createElement("div");f.className="layer-name",f.innerHTML=a.name;var g=document.createElement("li");g.className="layer-element "+a.name,f.onclick=function(b){-1==b.currentTarget.className.indexOf("selected")?(b.currentTarget.className+=" selected",this.selection.add({info:a,layer:d})):(this.selection.remove(d),b.currentTarget.className="layer-name")}.bind(this),e.onchange=function(){e.checked?this.map.addLayer(d):this.map.hasLayer(d)&&this.map.removeLayer(d)}.bind(this),document.getElementById("fileList").appendChild(g),g.appendChild(e),g.appendChild(f),this.numLayers++},updateDownload:function(a){download.href="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a))}},Object.defineProperty(e.prototype,"dnc_registration_event_name",{get:function(){return"register-dnc-event-handlers"}}),Object.defineProperty(e.prototype,"dnc_registration_event",{writeable:!1,configurable:!1,value:function(){var a=new CustomEvent(e.prototype.dnc_registration_event_name,{detail:{},bubbles:!0,cancelable:!0});return a.extra_data={},a}()}),b.exports=new e},{"../dropzone":2,"../geoprocessing_menu":3}]},{},[1]);
//# sourceMappingURL=dnc.min.js.map